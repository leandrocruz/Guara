<polymer-element name="g-input" extends="g-base" attributes="form field onChange class">
	<template>
		<link rel="stylesheet" href="g-input.css">
		<div id="input">
			<template if="{{ field.type == 'hidden' }}">
				<input	name="{{ field.name }}"
						type="{{ field.type }}"
						value="{{ field.value }}" />									
			</template>
			<template if="{{ field.type == 'text' || field.type == 'password' }}">
				<input 	on-keyup="{{ onKeyUp }}" 
						name="{{ field.name }}"
						type="{{ field.type }}"
						class="{{ class }}"
						placeholder="{{ field.placeholder }}"
						tabindex="{{ tab }}" />
			</template>
			<template if="{{ field.type == 'select' }}">
				<g-dropdown label="{{ field.placeholder }}" options="{{ field.options }}"></g-dropdown>
			</template>
			<template if="{{ field.type == 'button' }}">
				<button	on-click="{{ buttonClicked }}" 
						name="{{ field.name }}"
						type="submit"
						class="{{ class }} btn-primary"
						tabindex="{{ tab }}">{{ field.placeholder }}</button>
			</template>
		</div>			
	</template>
	<script>
    	Polymer({
			
    		form  : null,
    		class : 'form-control',
    		
    		attached: function() {
    			var el = this.getElement('input') || this.getElement('g-dropdown');
				if(!el)
				{
					throw 'Field: #' + this.field.id + ' not found';	
				}
  				this.field.entry = new FieldEntry(this.field, $(el));
    		},

    		getElement: function(name) {
    			var input = this.$.input;
    			return $(name, input)[0];
    		},
    		
			entry: function() {
				return this.field.entry;
			},
			
			value: function() {
				return this.entry().value();
			},
    		
			status: function() {
    			var status = this.entry().isValid();
    			return status;
			},

			highlight: function() {
    			var status = this.status();
    			this.entry().highlight(status);
			},
			
    		onKeyUp: function(evt, detail, sender) {
				this.highlight();
				$g.utils.apply(this.onChange, [this]);
    		},
    		
    		buttonClicked: function(evt, detail, sender) {
    			if(this.field.onClick)
    			{
    				this.field.onClick(this.form, this.field, evt, detail, sender);
    			}
    			else
    			{
    				evt.preventDefault();
    			}
    		},
    	});
	</script>
</polymer-element>